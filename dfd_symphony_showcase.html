<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Symphony IDE - Data Flow Diagram (Level-1)</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: #f5f5f5;
      padding: 2rem;
      overflow: auto;
    }
    
    .container {
      width: 100%;
      max-width: 100%;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      padding: 2rem;
    }
    
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
      padding-bottom: 1rem;
      border-bottom: 2px solid #e5e7eb;
    }
    
    h1 {
      font-size: 1.75rem;
      font-weight: bold;
      color: #111827;
    }
    
    .buttons {
      display: flex;
      gap: 0.75rem;
    }
    
    button {
      padding: 0.625rem 1.25rem;
      background: linear-gradient(135deg, #333333 0%, #1a1a1a 100%);
      color: white;
      border: none;
      border-radius: 0.5rem;
      cursor: pointer;
      font-size: 0.875rem;
      font-weight: 600;
      transition: all 0.2s;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }
    
    button:hover {
      background: linear-gradient(135deg, #1a1a1a 0%, #000000 100%);
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
    }
    
    .diagram-wrapper {
      background: white;
      border-radius: 8px;
      border: 2px solid #d1d5db;
      padding: 1rem;
      overflow-x: auto;
    }
    
    svg {
      width: 100%;
      height: auto;
      min-width: 100%;
      border: 1px solid #e5e7eb;
      border-radius: 4px;
    }

    .legend {
      margin-top: 1.5rem;
      padding: 1rem;
      background: #f9fafb;
      border-radius: 8px;
      border: 1px solid #e5e7eb;
    }

    .legend h3 {
      font-size: 1rem;
      font-weight: 600;
      color: #1f2937;
      margin-bottom: 0.75rem;
    }

    .legend-items {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 0.75rem;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.875rem;
      color: #6b7280;
    }

    .legend-shape {
      width: 40px;
      height: 24px;
      border: 2px solid #4a90e2;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7rem;
      color: #1f2937;
    }

    .legend-shape.process {
      border-radius: 12px;
      background: #e0f2fe;
    }

    .legend-shape.entity {
      border-radius: 2px;
      background: #f3f4f6;
    }

    .legend-shape.datastore {
      border-left: none;
      background: white;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Symphony IDE - Data Flow Diagram (Level-1 Showcase)</h1>
      <div class="buttons">
        <button onclick="saveToPNG()">ðŸ’¾ Save as PNG</button>
        <button onclick="saveToPDF()">ðŸ“„ Save as PDF</button>
      </div>
    </div>
    
    <div class="diagram-wrapper">
      <svg id="diagram" viewBox="0 0 1400 1100" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <!-- Arrow marker for data flows -->
          <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
            <polygon points="0 0, 10 3, 0 6" fill="#1f2937" />
          </marker>

          <!-- Shadow filter -->
          <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
            <feGaussianBlur in="SourceAlpha" stdDeviation="2"/>
            <feOffset dx="2" dy="2" result="offsetblur"/>
            <feComponentTransfer>
              <feFuncA type="linear" slope="0.15"/>
            </feComponentTransfer>
            <feMerge>
              <feMergeNode/>
              <feMergeNode in="SourceGraphic"/>
            </feMerge>
          </filter>
        </defs>

        <!-- Title -->
        <text x="700" y="30" text-anchor="middle" font-size="18" font-weight="bold" fill="#1f2937">
          Symphony IDE - Extension Development Workflow (DFD Level-1)
        </text>

        <!-- ============================================ -->
        <!-- EXTERNAL ENTITIES (Rectangles) -->
        <!-- ============================================ -->
        
        <!-- Developer (External Entity) -->
        <rect x="50" y="150" width="160" height="80" rx="4" fill="#f3f4f6" stroke="#6b7280" stroke-width="2" filter="url(#shadow)"/>
        <text x="130" y="195" text-anchor="middle" font-size="14" font-weight="600" fill="#1f2937">Developer</text>

        <!-- Extension Marketplace (External Entity) -->
        <rect x="1190" y="150" width="160" height="80" rx="4" fill="#f3f4f6" stroke="#6b7280" stroke-width="2" filter="url(#shadow)"/>
        <text x="1270" y="185" text-anchor="middle" font-size="14" font-weight="600" fill="#1f2937">Extension</text>
        <text x="1270" y="205" text-anchor="middle" font-size="14" font-weight="600" fill="#1f2937">Marketplace</text>

        <!-- ============================================ -->
        <!-- PROCESSES (Rounded Rectangles with Numbers) -->
        <!-- ============================================ -->

        <!-- Process 1.0: Create Extension -->
        <rect x="320" y="140" width="180" height="100" rx="20" fill="#e0f2fe" stroke="#4a90e2" stroke-width="2" filter="url(#shadow)"/>
        <text x="410" y="168" text-anchor="middle" font-size="12" font-weight="bold" fill="#0284c7">1.0</text>
        <line x1="340" y1="178" x2="480" y2="178" stroke="#4a90e2" stroke-width="1.5"/>
        <text x="410" y="200" text-anchor="middle" font-size="14" font-weight="500" fill="#1f2937">Create Extension</text>
        <text x="410" y="220" text-anchor="middle" font-size="11" fill="#6b7280">(Carets CLI)</text>

        <!-- Process 2.0: Validate Extension -->
        <rect x="610" y="140" width="180" height="100" rx="20" fill="#e0f2fe" stroke="#4a90e2" stroke-width="2" filter="url(#shadow)"/>
        <text x="700" y="168" text-anchor="middle" font-size="12" font-weight="bold" fill="#0284c7">2.0</text>
        <line x1="630" y1="178" x2="770" y2="178" stroke="#4a90e2" stroke-width="1.5"/>
        <text x="700" y="200" text-anchor="middle" font-size="14" font-weight="500" fill="#1f2937">Validate Extension</text>
        <text x="700" y="220" text-anchor="middle" font-size="11" fill="#6b7280">(Manifest Parser)</text>

        <!-- Process 3.0: Package Extension -->
        <rect x="900" y="140" width="180" height="100" rx="20" fill="#e0f2fe" stroke="#4a90e2" stroke-width="2" filter="url(#shadow)"/>
        <text x="990" y="168" text-anchor="middle" font-size="12" font-weight="bold" fill="#0284c7">3.0</text>
        <line x1="920" y1="178" x2="1060" y2="178" stroke="#4a90e2" stroke-width="1.5"/>
        <text x="990" y="200" text-anchor="middle" font-size="14" font-weight="500" fill="#1f2937">Package Extension</text>
        <text x="990" y="220" text-anchor="middle" font-size="11" fill="#6b7280">(Build & Sign)</text>

        <!-- Process 4.0: Install Extension -->
        <rect x="320" y="480" width="180" height="100" rx="20" fill="#fef3c7" stroke="#f59e0b" stroke-width="2" filter="url(#shadow)"/>
        <text x="410" y="508" text-anchor="middle" font-size="12" font-weight="bold" fill="#d97706">4.0</text>
        <line x1="340" y1="518" x2="480" y2="518" stroke="#f59e0b" stroke-width="1.5"/>
        <text x="410" y="540" text-anchor="middle" font-size="14" font-weight="500" fill="#1f2937">Install Extension</text>
        <text x="410" y="560" text-anchor="middle" font-size="11" fill="#6b7280">(Installer)</text>

        <!-- Process 5.0: Load & Activate -->
        <rect x="610" y="480" width="180" height="100" rx="20" fill="#fef3c7" stroke="#f59e0b" stroke-width="2" filter="url(#shadow)"/>
        <text x="700" y="508" text-anchor="middle" font-size="12" font-weight="bold" fill="#d97706">5.0</text>
        <line x1="630" y1="518" x2="770" y2="518" stroke="#f59e0b" stroke-width="1.5"/>
        <text x="700" y="540" text-anchor="middle" font-size="14" font-weight="500" fill="#1f2937">Load & Activate</text>
        <text x="700" y="560" text-anchor="middle" font-size="11" fill="#6b7280">(Lifecycle Manager)</text>

        <!-- Process 6.0: Execute Extension -->
        <rect x="900" y="480" width="180" height="100" rx="20" fill="#dcfce7" stroke="#10b981" stroke-width="2" filter="url(#shadow)"/>
        <text x="990" y="508" text-anchor="middle" font-size="12" font-weight="bold" fill="#059669">6.0</text>
        <line x1="920" y1="518" x2="1060" y2="518" stroke="#10b981" stroke-width="1.5"/>
        <text x="990" y="540" text-anchor="middle" font-size="14" font-weight="500" fill="#1f2937">Execute Extension</text>
        <text x="990" y="560" text-anchor="middle" font-size="11" fill="#6b7280">(Pool Manager)</text>

        <!-- ============================================ -->
        <!-- DATA STORES (Open-ended Rectangles) -->
        <!-- ============================================ -->

        <!-- D1: Extension Registry -->
        <rect x="320" y="750" width="180" height="60" fill="#ffffff" stroke="#4a90e2" stroke-width="2" filter="url(#shadow)"/>
        <line x1="320" y1="750" x2="320" y2="810" stroke="#ffffff" stroke-width="4"/>
        <line x1="360" y1="750" x2="360" y2="810" stroke="#4a90e2" stroke-width="1.5"/>
        <text x="335" y="785" text-anchor="middle" font-size="12" font-weight="bold" fill="#0284c7">D1</text>
        <text x="430" y="785" text-anchor="middle" font-size="13" font-weight="500" fill="#1f2937">Extension Registry</text>

        <!-- D2: Extension Packages -->
        <rect x="610" y="750" width="180" height="60" fill="#ffffff" stroke="#4a90e2" stroke-width="2" filter="url(#shadow)"/>
        <line x1="610" y1="750" x2="610" y2="810" stroke="#ffffff" stroke-width="4"/>
        <line x1="650" y1="750" x2="650" y2="810" stroke="#4a90e2" stroke-width="1.5"/>
        <text x="625" y="785" text-anchor="middle" font-size="12" font-weight="bold" fill="#0284c7">D2</text>
        <text x="720" y="785" text-anchor="middle" font-size="13" font-weight="500" fill="#1f2937">Extension Packages</text>

        <!-- D3: Runtime State -->
        <rect x="900" y="750" width="180" height="60" fill="#ffffff" stroke="#4a90e2" stroke-width="2" filter="url(#shadow)"/>
        <line x1="900" y1="750" x2="900" y2="810" stroke="#ffffff" stroke-width="4"/>
        <line x1="940" y1="750" x2="940" y2="810" stroke="#4a90e2" stroke-width="1.5"/>
        <text x="915" y="785" text-anchor="middle" font-size="12" font-weight="bold" fill="#0284c7">D3</text>
        <text x="1010" y="785" text-anchor="middle" font-size="13" font-weight="500" fill="#1f2937">Runtime State</text>

        <!-- ============================================ -->
        <!-- DATA FLOWS (Elbow Connectors with Labels) -->
        <!-- ============================================ -->

        <!-- Developer to Process 1.0 -->
        <path d="M 210 190 L 260 190 L 260 190 L 320 190" stroke="#1f2937" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
        <rect x="235" y="182" width="90" height="16" fill="white" opacity="0.9"/>
        <text x="280" y="193" text-anchor="middle" font-size="11" fill="#6b7280">Extension code</text>

        <!-- Process 1.0 to Process 2.0 -->
        <path d="M 500 190 L 555 190 L 555 190 L 610 190" stroke="#1f2937" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
        <rect x="505" y="182" width="100" height="16" fill="white" opacity="0.9"/>
        <text x="555" y="193" text-anchor="middle" font-size="11" fill="#6b7280">Extension manifest</text>

        <!-- Process 2.0 to Process 3.0 -->
        <path d="M 790 190 L 845 190 L 845 190 L 900 190" stroke="#1f2937" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
        <rect x="790" y="182" width="110" height="16" fill="white" opacity="0.9"/>
        <text x="845" y="193" text-anchor="middle" font-size="11" fill="#6b7280">Validated extension</text>

        <!-- Process 3.0 to Marketplace -->
        <path d="M 1080 190 L 1135 190 L 1135 190 L 1190 190" stroke="#1f2937" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
        <rect x="1085" y="182" width="100" height="16" fill="white" opacity="0.9"/>
        <text x="1135" y="193" text-anchor="middle" font-size="11" fill="#6b7280">Signed package</text>

        <!-- Marketplace to Process 4.0 (Elbow) -->
        <path d="M 1270 230 L 1270 358 L 410 358 L 410 480" stroke="#1f2937" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
        <rect x="820" y="350" width="110" height="16" fill="white" opacity="0.9"/>
        <text x="875" y="361" text-anchor="middle" font-size="11" fill="#6b7280">Download request</text>

        <!-- Developer to Process 4.0 (Elbow) -->
        <path d="M 130 230 L 130 362 L 280 362 L 280 530 L 320 530" stroke="#1f2937" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
        <rect x="175" y="522" width="100" height="16" fill="white" opacity="0.9"/>
        <text x="225" y="533" text-anchor="middle" font-size="11" fill="#6b7280">Install command</text>

        <!-- Process 4.0 to D1 (Elbow) -->
        <path d="M 410 580 L 410 665 L 410 665 L 410 750" stroke="#1f2937" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
        <rect x="360" y="657" width="115" height="16" fill="white" opacity="0.9"/>
        <text x="417" y="668" text-anchor="middle" font-size="11" fill="#6b7280">Extension metadata</text>

        <!-- Process 4.0 to Process 5.0 -->
        <path d="M 500 530 L 555 530 L 555 530 L 610 530" stroke="#1f2937" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
        <rect x="515" y="522" width="80" height="16" fill="white" opacity="0.9"/>
        <text x="555" y="533" text-anchor="middle" font-size="11" fill="#6b7280">Extension ID</text>

        <!-- D1 to Process 5.0 (Elbow - Read) -->
        <path d="M 410 750 L 410 678 L 650 678 L 650 580" stroke="#1f2937" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
        <rect x="480" y="670" width="95" height="16" fill="white" opacity="0.9"/>
        <text x="527" y="681" text-anchor="middle" font-size="11" fill="#6b7280">Registry lookup</text>

        <!-- Process 5.0 to D2 (Elbow) -->
        <path d="M 700 580 L 700 665 L 700 665 L 700 750" stroke="#1f2937" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
        <rect x="650" y="657" width="100" height="16" fill="white" opacity="0.9"/>
        <text x="700" y="668" text-anchor="middle" font-size="11" fill="#6b7280">Store extension</text>

        <!-- D2 to Process 5.0 (Elbow - Read) -->
        <path d="M 750 750 L 750 682 L 740 682 L 740 580" stroke="#1f2937" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
        <rect x="700" y="674" width="95" height="16" fill="white" opacity="0.9"/>
        <text x="747" y="685" text-anchor="middle" font-size="11" fill="#6b7280">Load extension</text>

        <!-- Process 5.0 to Process 6.0 -->
        <path d="M 790 530 L 845 530 L 845 530 L 900 530" stroke="#1f2937" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
        <rect x="795" y="522" width="105" height="16" fill="white" opacity="0.9"/>
        <text x="847" y="533" text-anchor="middle" font-size="11" fill="#6b7280">Extension handle</text>

        <!-- Process 6.0 to D3 (Elbow) -->
        <path d="M 990 580 L 990 665 L 990 665 L 990 750" stroke="#1f2937" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
        <rect x="940" y="657" width="100" height="16" fill="white" opacity="0.9"/>
        <text x="990" y="668" text-anchor="middle" font-size="11" fill="#6b7280">Execution state</text>

        <!-- D3 to Process 6.0 (Elbow - Read) -->
        <path d="M 1040 750 L 1040 680 L 1030 680 L 1030 580" stroke="#1f2937" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
        <rect x="995" y="672" width="80" height="16" fill="white" opacity="0.9"/>
        <text x="1035" y="683" text-anchor="middle" font-size="11" fill="#6b7280">State query</text>

        <!-- Process 6.0 to Developer (Elbow) -->
        <path d="M 990 480 L 990 364 L 130 364 L 130 230" stroke="#1f2937" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
        <rect x="505" y="356" width="105" height="16" fill="white" opacity="0.9"/>
        <text x="557" y="367" text-anchor="middle" font-size="11" fill="#6b7280">Extension output</text>

        <!-- Legend Box -->
        <rect x="50" y="900" width="1300" height="140" rx="8" fill="#f9fafb" stroke="#d1d5db" stroke-width="1"/>
        <text x="70" y="925" font-size="14" font-weight="bold" fill="#1f2937">Legend</text>
        
        <!-- Process example -->
        <rect x="70" y="945" width="100" height="60" rx="15" fill="#e0f2fe" stroke="#4a90e2" stroke-width="2"/>
        <text x="120" y="965" text-anchor="middle" font-size="10" font-weight="bold" fill="#0284c7">1.0</text>
        <line x1="85" y1="975" x2="155" y2="975" stroke="#4a90e2" stroke-width="1.5"/>
        <text x="120" y="995" text-anchor="middle" font-size="11" fill="#1f2937">Process</text>
        
        <!-- Entity example -->
        <rect x="220" y="945" width="100" height="60" rx="3" fill="#f3f4f6" stroke="#6b7280" stroke-width="2"/>
        <text x="270" y="980" text-anchor="middle" font-size="11" fill="#1f2937">External Entity</text>
        
        <!-- Data Store example -->
        <rect x="370" y="945" width="100" height="60" fill="#ffffff" stroke="#4a90e2" stroke-width="2"/>
        <line x1="370" y1="945" x2="370" y2="1005" stroke="#ffffff" stroke-width="4"/>
        <line x1="400" y1="945" x2="400" y2="1005" stroke="#4a90e2" stroke-width="1.5"/>
        <text x="385" y="980" text-anchor="middle" font-size="10" font-weight="bold" fill="#0284c7">D1</text>
        <text x="435" y="980" text-anchor="middle" font-size="11" fill="#1f2937">Data Store</text>
        
        <!-- Data Flow example -->
        <line x1="520" y1="975" x2="620" y2="975" stroke="#1f2937" stroke-width="2" marker-end="url(#arrowhead)"/>
        <rect x="540" y="967" width="60" height="16" fill="white" opacity="0.9"/>
        <text x="570" y="978" text-anchor="middle" font-size="11" fill="#6b7280">Data flow</text>

        <!-- Notes -->
        <text x="720" y="960" font-size="11" fill="#6b7280">â€¢ Processes transform data (numbered 1.0, 2.0, etc.)</text>
        <text x="720" y="980" font-size="11" fill="#6b7280">â€¢ Horizontal separator divides number from name</text>
        <text x="720" y="1000" font-size="11" fill="#6b7280">â€¢ External entities are sources/destinations of data</text>
        <text x="1050" y="960" font-size="11" fill="#6b7280">â€¢ Data stores persist information (D1, D2, etc.)</text>
        <text x="1050" y="980" font-size="11" fill="#6b7280">â€¢ Vertical separator in data stores (left side)</text>
        <text x="1050" y="1000" font-size="11" fill="#6b7280">â€¢ Data flows labeled on connection lines</text>

      </svg>
    </div>

    <div class="legend">
      <h3>ðŸ§© DFD Level-1 Structure (Standard Rules)</h3>
      <div class="legend-items">
        <div class="legend-item">
          <div class="legend-shape process">1.0</div>
          <span><strong>Process:</strong> Transforms data (e.g., Validate Extension)</span>
        </div>
        <div class="legend-item">
          <div class="legend-shape entity"></div>
          <span><strong>External Entity:</strong> Source/destination of data (e.g., Developer)</span>
        </div>
        <div class="legend-item">
          <div class="legend-shape datastore">D1</div>
          <span><strong>Data Store:</strong> Persistent storage (e.g., Extension Registry)</span>
        </div>
        <div class="legend-item">
          <span style="margin-left: 0;">â†’</span>
          <span><strong>Data Flow:</strong> Movement of data with elbow connectors</span>
        </div>
      </div>
    </div>
  </div>

  <script>
    function saveToPNG() {
      const diagram = document.getElementById('diagram');
      html2canvas(diagram, {
        backgroundColor: '#ffffff',
        scale: 2
      }).then(canvas => {
        const link = document.createElement('a');
        link.download = 'symphony-dfd-level1.png';
        link.href = canvas.toDataURL();
        link.click();
      });
    }

    function saveToPDF() {
      window.print();
    }
  </script>
</body>
</html>
